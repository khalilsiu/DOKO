{"ast":null,"code":"import _slicedToArray from \"/Users/anthonysiu/doko/DOKO/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"/Users/anthonysiu/doko/DOKO/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"/Users/anthonysiu/doko/DOKO/client/src/modules/meta-stats-page/StatsView.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { Button, makeStyles, useMediaQuery, Typography, useTheme, withStyles, MenuItem, IconButton } from '@material-ui/core';\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\nimport ClearIcon from '@material-ui/icons/Clear';\nimport SearchIcon from '@material-ui/icons/Search';\nimport { DataGrid } from '@mui/x-data-grid';\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { forwardRef } from 'react';\nimport { RadiusInput } from '../../components';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar escapeRegExp = function escapeRegExp(value) {\n  return value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\n};\n\nvar useStyles = makeStyles(function (theme) {\n  return {\n    menuItem: {\n      backgroundColor: 'white',\n      '&:hover': {\n        backgroundColor: '#EBEBEB'\n      }\n    },\n    resultsText: {\n      color: theme.palette.grey[500],\n      fontSize: '0.8rem',\n      fontStyle: 'italic',\n      marginBottom: '0.4rem'\n    },\n    timeframeMenu: {\n      position: 'absolute',\n      right: 0,\n      boxShadow: 'rgb(4 17 29 / 25%) 0px 0px 8px 0px',\n      borderRadius: '10px',\n      overflow: 'hidden',\n      padding: '0.5rem 0 0.5rem 0',\n      backgroundColor: 'white',\n      minWidth: 'content-fit',\n      zIndex: 10000\n    },\n    statsTable: {\n      height: '700px',\n      borderRadius: '10px',\n      overflow: 'hidden',\n      padding: '0.5rem 0 0.5rem 0',\n      backgroundColor: 'white',\n      minWidth: 'content-fit'\n    }\n  };\n});\nexport var timeframeOptions = [{\n  id: 'ytd',\n  label: 'Yesterday'\n}, {\n  id: 'weekly',\n  label: '7D'\n}, {\n  id: 'monthly',\n  label: '30D'\n}, {\n  id: 'all',\n  label: 'All'\n}];\nvar columns = [{\n  field: 'coordinates',\n  headerName: 'Coordinates',\n  width: 160\n}, {\n  field: 'ytdUsers',\n  headerName: 'Ytd Users',\n  width: 250\n}, {\n  field: 'ytdSessions',\n  headerName: 'Ytd Sessions',\n  width: 250\n}, {\n  field: 'ytdMedianSessionTime',\n  headerName: 'Ytd Median Session Time',\n  width: 250\n}, {\n  field: 'ytdMaxConcurrentUsers',\n  headerName: 'Ytd Max Concurrent Users',\n  width: 250\n}, {\n  field: 'weeklyUsers',\n  headerName: '7D Users',\n  width: 250\n}, {\n  field: 'weeklySessions',\n  headerName: '7D Sessions',\n  width: 250\n}, {\n  field: 'weeklyMedianSessionTime',\n  headerName: '7D Median Session Time',\n  width: 250\n}, {\n  field: 'weeklyMaxConcurrentUsers',\n  headerName: '7D Max Concurrent Users',\n  width: 250\n}, {\n  field: 'monthlyUsers',\n  headerName: '30D Users',\n  width: 250\n}, {\n  field: 'monthlySessions',\n  headerName: '30D Sessions',\n  width: 250\n}, {\n  field: 'monthlyMedianSessionTime',\n  headerName: '30D Median Session Time',\n  width: 250\n}, {\n  field: 'monthlyMaxConcurrentUsers',\n  headerName: '30D Max Concurrent Users',\n  width: 250\n}];\nvar StyledButton = withStyles(function (theme) {\n  return {\n    root: _defineProperty({\n      minWidth: '300px',\n      borderWidth: '2px'\n    }, theme.breakpoints.down('md'), {\n      minWidth: '100px'\n    })\n  };\n})(Button);\n\nvar QuickSearchToolbar = function QuickSearchToolbar(props) {\n  return /*#__PURE__*/_jsxDEV(RadiusInput, {\n    value: props.value,\n    onChange: props.onChange,\n    placeholder: \"Search\\u2026\",\n    startAdornment: /*#__PURE__*/_jsxDEV(SearchIcon, {\n      fontSize: \"small\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 21\n    }, _this),\n    endAdornment: /*#__PURE__*/_jsxDEV(IconButton, {\n      title: \"Clear\",\n      \"aria-label\": \"Clear\",\n      size: \"small\",\n      style: {\n        visibility: props.value ? 'visible' : 'hidden'\n      },\n      onClick: props.clearSearch,\n      children: /*#__PURE__*/_jsxDEV(ClearIcon, {\n        fontSize: \"small\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 116,\n    columnNumber: 3\n  }, _this);\n};\n\n_c = QuickSearchToolbar;\nvar StatsView = /*#__PURE__*/forwardRef(_c2 = _s(function (_ref) {\n  var _timeframeOptions$fin;\n\n  _s();\n\n  var stats = _ref.stats,\n      isLoading = _ref.isLoading;\n  var styles = useStyles();\n  var theme = useTheme();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      timeframeOpen = _useState2[0],\n      setTimeframeOpen = _useState2[1];\n\n  var _useState3 = useState(timeframeOptions[0].id),\n      _useState4 = _slicedToArray(_useState3, 2),\n      timeframeSelected = _useState4[0],\n      setTimeframeSelected = _useState4[1];\n\n  var mdOrAbove = useMediaQuery(function (theme) {\n    return theme.breakpoints.up('md');\n  });\n  var ref = useRef(null);\n\n  var _React$useState = React.useState(''),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      searchText = _React$useState2[0],\n      setSearchText = _React$useState2[1];\n\n  var _React$useState3 = React.useState(stats),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      rows = _React$useState4[0],\n      setRows = _React$useState4[1];\n\n  var requestSearch = function requestSearch(searchValue) {\n    setSearchText(searchValue);\n    var searchRegex = new RegExp(escapeRegExp(searchValue), 'i');\n    var filteredRows = stats.filter(function (row) {\n      return searchRegex.test(row.coordinates.toString());\n    });\n    setRows(filteredRows);\n  };\n\n  var handleTimeframeChange = function handleTimeframeChange(newTimeframeId) {\n    setTimeframeOpen(false);\n    setTimeframeSelected(newTimeframeId);\n  };\n\n  var handleOffMenuClick = function handleOffMenuClick(e) {\n    if (ref.current && !ref.current.contains(e.target)) {\n      setTimeframeOpen(false);\n    }\n  };\n\n  useEffect(function () {\n    if (typeof window !== 'undefined') {\n      window.addEventListener('mousedown', handleOffMenuClick);\n    }\n\n    return function () {\n      window.removeEventListener('mousedown', handleOffMenuClick);\n    };\n  }, []);\n  useEffect(function () {\n    setRows(stats);\n  }, [stats]);\n  var columnsDisplayed = useMemo(function () {\n    return columns.filter(function (column) {\n      return (// show all columns when timeframe selected is all\n        timeframeSelected === 'all' || // always show coordinates column\n        column.field === 'coordinates' || // show columns corresponding to timeframe selected\n        column.field.includes(timeframeSelected)\n      );\n    });\n  }, [columns, timeframeSelected]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'space-between'\n      },\n      children: [/*#__PURE__*/_jsxDEV(QuickSearchToolbar, {\n        value: searchText,\n        onChange: function onChange(event) {\n          return requestSearch(event.target.value);\n        },\n        clearSearch: function clearSearch() {\n          return requestSearch('');\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'relative'\n        },\n        children: [/*#__PURE__*/_jsxDEV(StyledButton, {\n          className: \"gradient-button\",\n          disabled: false,\n          variant: \"outlined\",\n          onClick: function onClick() {\n            return setTimeframeOpen(!timeframeOpen);\n          },\n          style: {},\n          children: [mdOrAbove && ((_timeframeOptions$fin = timeframeOptions.find(function (item) {\n            return item.id === timeframeSelected;\n          })) === null || _timeframeOptions$fin === void 0 ? void 0 : _timeframeOptions$fin.label), /*#__PURE__*/_jsxDEV(ArrowDropDownIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 11\n        }, _this), timeframeOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.timeframeMenu,\n          ref: ref,\n          children: timeframeOptions.map(function (timeframe, index) {\n            return /*#__PURE__*/_jsxDEV(MenuItem, {\n              value: index,\n              onClick: function onClick() {\n                return handleTimeframeChange(timeframe.id);\n              },\n              className: styles.menuItem,\n              style: timeframe.id === timeframeSelected ? {\n                backgroundColor: theme.palette.grey[300]\n              } : {},\n              children: timeframe.label\n            }, timeframe.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 17\n            }, _this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"subtitle2\",\n      className: styles.resultsText,\n      children: [\"Results showing: \", stats.length, \" listings\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(DataGrid, {\n      className: styles.statsTable,\n      rows: rows,\n      columns: columnsDisplayed,\n      componentsProps: {\n        toolbar: {\n          value: searchText,\n          onChange: function onChange(event) {\n            return requestSearch(event.target.value);\n          },\n          clearSearch: function clearSearch() {\n            return requestSearch('');\n          }\n        }\n      },\n      pageSize: 40,\n      columnBuffer: 10,\n      loading: isLoading\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 191,\n    columnNumber: 5\n  }, _this);\n}, \"RASFZA1PHMkLNRDf3lHKgMGcSEA=\", false, function () {\n  return [useStyles, useTheme, useMediaQuery];\n}));\n_c3 = StatsView;\nexport default StatsView;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"QuickSearchToolbar\");\n$RefreshReg$(_c2, \"StatsView$forwardRef\");\n$RefreshReg$(_c3, \"StatsView\");","map":{"version":3,"sources":["/Users/anthonysiu/doko/DOKO/client/src/modules/meta-stats-page/StatsView.tsx"],"names":["Button","makeStyles","useMediaQuery","Typography","useTheme","withStyles","MenuItem","IconButton","ArrowDropDownIcon","ClearIcon","SearchIcon","DataGrid","React","useEffect","useMemo","useRef","useState","forwardRef","RadiusInput","escapeRegExp","value","replace","useStyles","theme","menuItem","backgroundColor","resultsText","color","palette","grey","fontSize","fontStyle","marginBottom","timeframeMenu","position","right","boxShadow","borderRadius","overflow","padding","minWidth","zIndex","statsTable","height","timeframeOptions","id","label","columns","field","headerName","width","StyledButton","root","borderWidth","breakpoints","down","QuickSearchToolbar","props","onChange","visibility","clearSearch","StatsView","stats","isLoading","styles","timeframeOpen","setTimeframeOpen","timeframeSelected","setTimeframeSelected","mdOrAbove","up","ref","searchText","setSearchText","rows","setRows","requestSearch","searchValue","searchRegex","RegExp","filteredRows","filter","row","test","coordinates","toString","handleTimeframeChange","newTimeframeId","handleOffMenuClick","e","current","contains","target","window","addEventListener","removeEventListener","columnsDisplayed","column","includes","display","justifyContent","event","find","item","map","timeframe","index","length","toolbar"],"mappings":"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","sourcesContent":["import {\n  Button,\n  makeStyles,\n  useMediaQuery,\n  Theme,\n  Typography,\n  useTheme,\n  withStyles,\n  MenuItem,\n  IconButton,\n} from '@material-ui/core';\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\nimport ClearIcon from '@material-ui/icons/Clear';\nimport SearchIcon from '@material-ui/icons/Search';\nimport { DataGrid } from '@mui/x-data-grid';\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { forwardRef } from 'react';\nimport { RadiusInput } from '../../components';\nimport { DclStats } from '../../store/stats/dclStatsSlice';\n\ninterface IStatsView {\n  stats: DclStats[];\n  isLoading: boolean;\n}\n\ninterface QuickSearchToolbarProps {\n  clearSearch: () => void;\n  onChange: (e) => void;\n  value: string;\n}\n\nconst escapeRegExp = (value: string): string => {\n  return value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\n};\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  menuItem: {\n    backgroundColor: 'white',\n    '&:hover': {\n      backgroundColor: '#EBEBEB',\n    },\n  },\n  resultsText: {\n    color: theme.palette.grey[500],\n    fontSize: '0.8rem',\n    fontStyle: 'italic',\n    marginBottom: '0.4rem',\n  },\n  timeframeMenu: {\n    position: 'absolute',\n    right: 0,\n    boxShadow: 'rgb(4 17 29 / 25%) 0px 0px 8px 0px',\n    borderRadius: '10px',\n    overflow: 'hidden',\n    padding: '0.5rem 0 0.5rem 0',\n    backgroundColor: 'white',\n    minWidth: 'content-fit',\n    zIndex: 10000,\n  },\n  statsTable: {\n    height: '700px',\n    borderRadius: '10px',\n    overflow: 'hidden',\n    padding: '0.5rem 0 0.5rem 0',\n    backgroundColor: 'white',\n    minWidth: 'content-fit',\n  },\n}));\n\nexport const timeframeOptions = [\n  {\n    id: 'ytd',\n    label: 'Yesterday',\n  },\n  {\n    id: 'weekly',\n    label: '7D',\n  },\n  {\n    id: 'monthly',\n    label: '30D',\n  },\n  {\n    id: 'all',\n    label: 'All',\n  },\n];\n\nconst columns = [\n  { field: 'coordinates', headerName: 'Coordinates', width: 160 },\n  { field: 'ytdUsers', headerName: 'Ytd Users', width: 250 },\n  { field: 'ytdSessions', headerName: 'Ytd Sessions', width: 250 },\n  { field: 'ytdMedianSessionTime', headerName: 'Ytd Median Session Time', width: 250 },\n  { field: 'ytdMaxConcurrentUsers', headerName: 'Ytd Max Concurrent Users', width: 250 },\n  { field: 'weeklyUsers', headerName: '7D Users', width: 250 },\n  { field: 'weeklySessions', headerName: '7D Sessions', width: 250 },\n  { field: 'weeklyMedianSessionTime', headerName: '7D Median Session Time', width: 250 },\n  { field: 'weeklyMaxConcurrentUsers', headerName: '7D Max Concurrent Users', width: 250 },\n  { field: 'monthlyUsers', headerName: '30D Users', width: 250 },\n  { field: 'monthlySessions', headerName: '30D Sessions', width: 250 },\n  { field: 'monthlyMedianSessionTime', headerName: '30D Median Session Time', width: 250 },\n  { field: 'monthlyMaxConcurrentUsers', headerName: '30D Max Concurrent Users', width: 250 },\n];\n\nconst StyledButton = withStyles((theme: Theme) => ({\n  root: {\n    minWidth: '300px',\n    borderWidth: '2px',\n    [theme.breakpoints.down('md')]: {\n      minWidth: '100px',\n    },\n  },\n}))(Button);\n\nconst QuickSearchToolbar = (props: QuickSearchToolbarProps) => (\n  <RadiusInput\n    value={props.value}\n    onChange={props.onChange}\n    placeholder=\"Search…\"\n    startAdornment={<SearchIcon fontSize=\"small\" />}\n    endAdornment={\n      <IconButton\n        title=\"Clear\"\n        aria-label=\"Clear\"\n        size=\"small\"\n        style={{ visibility: props.value ? 'visible' : 'hidden' }}\n        onClick={props.clearSearch}\n      >\n        <ClearIcon fontSize=\"small\" />\n      </IconButton>\n    }\n  />\n);\n\nconst StatsView = forwardRef<HTMLDivElement, IStatsView>(({ stats, isLoading }: IStatsView) => {\n  const styles = useStyles();\n  const theme = useTheme();\n  const [timeframeOpen, setTimeframeOpen] = useState(false);\n  const [timeframeSelected, setTimeframeSelected] = useState(timeframeOptions[0].id);\n  const mdOrAbove = useMediaQuery((theme: Theme) => theme.breakpoints.up('md'));\n  const ref = useRef<HTMLDivElement>(null);\n  const [searchText, setSearchText] = React.useState('');\n  const [rows, setRows] = React.useState<DclStats[]>(stats);\n\n  const requestSearch = (searchValue: string) => {\n    setSearchText(searchValue);\n    const searchRegex = new RegExp(escapeRegExp(searchValue), 'i');\n    const filteredRows = stats.filter((row: DclStats) => {\n      return searchRegex.test(row.coordinates.toString());\n    });\n    setRows(filteredRows);\n  };\n\n  const handleTimeframeChange = (newTimeframeId: string) => {\n    setTimeframeOpen(false);\n    setTimeframeSelected(newTimeframeId);\n  };\n\n  const handleOffMenuClick = (e: MouseEvent) => {\n    if (ref.current && !ref.current.contains(e.target as Node)) {\n      setTimeframeOpen(false);\n    }\n  };\n\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      window.addEventListener('mousedown', handleOffMenuClick);\n    }\n    return () => {\n      window.removeEventListener('mousedown', handleOffMenuClick);\n    };\n  }, []);\n\n  useEffect(() => {\n    setRows(stats);\n  }, [stats]);\n\n  const columnsDisplayed = useMemo(() => {\n    return columns.filter(\n      (column) =>\n        // show all columns when timeframe selected is all\n        timeframeSelected === 'all' ||\n        // always show coordinates column\n        column.field === 'coordinates' ||\n        // show columns corresponding to timeframe selected\n        column.field.includes(timeframeSelected),\n    );\n  }, [columns, timeframeSelected]);\n\n  return (\n    <div>\n      <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n        <QuickSearchToolbar\n          value={searchText}\n          onChange={(event) => requestSearch(event.target.value)}\n          clearSearch={() => requestSearch('')}\n        />\n        <div style={{ position: 'relative' }}>\n          <StyledButton\n            className=\"gradient-button\"\n            disabled={false}\n            variant=\"outlined\"\n            onClick={() => setTimeframeOpen(!timeframeOpen)}\n            style={{}}\n          >\n            {mdOrAbove && timeframeOptions.find((item) => item.id === timeframeSelected)?.label}\n            <ArrowDropDownIcon />\n          </StyledButton>\n          {timeframeOpen && (\n            <div className={styles.timeframeMenu} ref={ref}>\n              {timeframeOptions.map((timeframe, index) => (\n                <MenuItem\n                  value={index}\n                  onClick={() => handleTimeframeChange(timeframe.id)}\n                  className={styles.menuItem}\n                  style={\n                    timeframe.id === timeframeSelected\n                      ? { backgroundColor: theme.palette.grey[300] }\n                      : {}\n                  }\n                  key={timeframe.id}\n                >\n                  {timeframe.label}\n                </MenuItem>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n      <Typography variant=\"subtitle2\" className={styles.resultsText}>\n        Results showing: {stats.length} listings\n      </Typography>\n      <DataGrid\n        className={styles.statsTable}\n        rows={rows}\n        columns={columnsDisplayed}\n        componentsProps={{\n          toolbar: {\n            value: searchText,\n            onChange: (event) => requestSearch(event.target.value),\n            clearSearch: () => requestSearch(''),\n          },\n        }}\n        pageSize={40}\n        columnBuffer={10}\n        loading={isLoading}\n      />\n    </div>\n  );\n});\n\nexport default StatsView;\n"]},"metadata":{},"sourceType":"module"}